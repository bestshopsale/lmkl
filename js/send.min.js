var forms=document.querySelectorAll(".lt-form"),lt_url="undefined"!=typeof lt_link?lt_link:"https://leadtrade.ru",aim=void 0!==aim?aim:1;function leadtradeFormSubmit(e){e.preventDefault();var t=this.querySelector("input[name=name]");if(t)var n=t.value;var r=this.querySelector("input[name=phone]");if(r)var u=r.value;if(u.length<10){var i="";return i="undefined"!=typeof lt_land_lang?"ru"===lt_land_lang?"Заполните номер!":"Fill in phone number!":"Заполните номер!",alert(i),!1}var a=this.querySelector("[name=aim]");a&&(aim=a.value);var l=this.querySelector("input[name=comment],input[name=comments]"),o="";l&&(o=l.value);var s=this.querySelector("input[name=productsum]"),d=0;s&&(d=s.value);var p="undefined"!=typeof lt_landing_id?lt_landing_id:0,c=null!=this.querySelector("input[name=subid1]")?this.querySelector("input[name=subid1]").value:"",m=null!=this.querySelector("input[name=subid2]")?this.querySelector("input[name=subid2]").value:"",f=null!=this.querySelector("input[name=subid3]")?this.querySelector("input[name=subid3]").value:"",y=null!=this.querySelector("input[name=subid4]")?this.querySelector("input[name=subid4]").value:"",h=this,b={};["address","index","city","email"].forEach(function(e){b[e]=null!=h.querySelector("input[name="+e+"]")?h.querySelector("input[name="+e+"]").value:""});var v={hash:hash,landing_id:p,subid1:getQueryVariable("subid1",c),subid2:getQueryVariable("subid2",m),subid3:getQueryVariable("subid3",f),subid4:getQueryVariable("subid4",y),ip:!1,name:n,phone:u,productsum:d,type:"undefined"!=typeof lt_type?lt_type:"",comment:o,data:b};return void 0!==aim&&(v.aim=aim),document.querySelectorAll("input[name*=description]").forEach(function(e,t){v[e.name]=e.value}),request("POST",lt_url+"/api/send_lead",v,function(e,t){var r=JSON.parse(e),i=document.createElement("form"),a="undefined"!=typeof success_page?success_page:lt_url+"/landing/success",l="undefined"!=typeof failure_page?failure_page:lt_url+"/landing/fail";"Spam"===r.error?i.setAttribute("action",l):i.setAttribute("action",a);var o,s="post";"undefined"!=typeof lt_html_version&&(s="get"),i.setAttribute("method",s);var d={tracking:r.lead,number:r.mm_number,order_name:n,order_phone:u,aim:aim,landing_id:p};for(var c in d)(o=document.createElement("input")).setAttribute("type","hidden"),o.setAttribute("name",c),o.value=d[c],i.appendChild(o);document.body.appendChild(i),i.submit()}),!1}function request(e,t,n,r){var u=new XMLHttpRequest;u.open(e,t),"POST"==e&&u.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),u.onload=function(){200==u.status?r(u.responseText,u):alert("Не удалось получить данные")},u.send(http_build_query(n))}function requestJSON(e,t,n,r){var u=new XMLHttpRequest;u.open(e,t),u.onload=function(){200==u.status?r(JSON.parse(u.responseText),u):alert("Не удалось получить данные")},u.send(JSON.stringify(n))}function getQueryVariable(e,t){for(var n=window.location.search.substring(1).split("&"),r=0;r<n.length;r++){var u=n[r].split("=");if(u[0]===e)return u[1]}return t}function http_build_query(e,t,n){var r,u,i=function(e){return encodeURIComponent(e).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A").replace(/%20/g,"+")},a=[],l=function(e,t,n){var r,u=[];if(!0===t?t="1":!1===t&&(t="0"),null!==t){if("object"==typeof t){for(r in t)null!==t[r]&&u.push(l(e+"["+r+"]",t[r],n));return u.join(n)}if("function"!=typeof t)return i(e)+"="+i(t);throw new Error("There was an error processing for http_build_query().")}return""};for(u in n||(n="&"),e){r=e[u],t&&!isNaN(u)&&(u=String(t)+u);var o=l(u,r,n);""!==o&&a.push(o)}return a.join(n)}forms.forEach(function(e,t){e.addEventListener("submit",leadtradeFormSubmit)});